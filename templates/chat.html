<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with {{ reviewer.name }} - NeuralFeedback</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-gradient-dark min-h-screen flex flex-col">
    <header class="chat-shell-header">
        <a href="/reviews" class="btn-secondary">← Back to Feedback</a>
        <div class="chat-persona-summary">
            <div class="avatar-small">{{ reviewer.name[0] }}</div>
            <div>
                <h1 class="persona-name">{{ reviewer.name }}</h1>
                <p class="persona-info">{{ reviewer.profession }}</p>
            </div>
        </div>
    </header>

    <main class="chat-stage">
        <section class="chat-panel animate-slide-up">
            <div class="chat-messages" id="chatMessages">
                <div class="message message-ai">
                    <div class="message-content">
                        <p>Hello! I've reviewed your idea. What would you like to know more about?</p>
                    </div>
                </div>
                <div class="message message-user">
                    <div class="message-content">
                        <p>What do you think of my idea?</p>
                    </div>
                </div>
                <div class="message message-ai">
                    <div class="message-content">
                        <p>I think it's innovative but could use clarity on target market. The core concept is solid, but defining your ideal customer persona would strengthen the value proposition significantly.</p>
                    </div>
                </div>
            </div>

            <form class="chat-input-container" id="chatForm">
                <input
                    type="text"
                    id="messageInput"
                    class="chat-input"
                    placeholder="Ask a follow-up question…"
                    autocomplete="off"
                >
                <button type="submit" class="btn-send">Send</button>
            </form>
        </section>

        <aside class="feedback-sidebar" id="feedbackSidebar">
            <div class="feedback-card animate-fade-in">
                <div class="feedback-card-header">
                    <p class="eyebrow">Live Summary</p>
                    <h2>Feedback Dashboard</h2>
                </div>

                <div class="sentiment-meter" aria-label="Sentiment rating">
                    <p class="sentiment-label">Current Sentiment</p>
                    <div class="persona-rating" id="liveSentimentRating" data-rating="3">
                        {% for i in range(5) %}
                        <svg class="star-icon{% if i < 3 %} star-filled{% endif %}" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="m12 3 2.4 5.8 6.1.5-4.6 4 1.4 6-5.3-3.2-5.3 3.2 1.4-6-4.6-4 6.1-.5z"/>
                        </svg>
                        {% endfor %}
                        <span class="rating-value" id="liveSentimentValue">3/5</span>
                    </div>
                </div>

                <div class="feedback-items" id="feedback-dashboard-list">
                    {% for item in feedback_items %}
                        <label class="feedback-item" data-item="{{ item }}">
                            <input type="checkbox" class="feedback-checkbox" data-text="{{ item }}" value="{{ item }}">
                            <span>{{ item }}</span>
                        </label>
                    {% endfor %}
                </div>

                <button
                    id="applyButton"
                    type="button"
                    class="btn-apply-feedback mt-4"
                >
                    Apply Changes
                </button>
            </div>
        </aside>
    </main>

    <script id="initial-feedback-items" type="application/json">
        {{ feedback_items | tojson | safe }}
    </script>
    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
</body>
</html>
